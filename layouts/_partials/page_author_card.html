{{ $profile := .profile }}
{{ $page := .page }}
{{ $site_type := site.Params.hugoblox.identity.type | humanize | default "Person" }}
{{ $avatar_shape := site.Params.hugoblox.layout.avatar_shape | default "circle" }}

{{ if $profile }}
  {{ $info := partial "author_link.html" (dict "profile" $profile "slug" $profile.slug) }}
  {{ $display := $info.display }}
  {{ $author_url := $info.url }}
  {{ $is_external := $info.is_external }}
  {{ $avatar := $profile.avatar }}

<div class="flex pt-12 pb-4">
  {{ if $avatar }}
    {{ $responsive := partial "functions/process_responsive_image.html" (dict 
        "image" $avatar 
        "mode" "fill"
        "aspect_ratio" "1:1"
        "anchor" "Center"
        "sizes" (slice 96 192 288 384)
    ) }}
    
    <img
      class="mr-4 h-24 w-24 {{if ne $avatar_shape "square"}}rounded-full{{end}}"
      srcset="{{ $responsive.srcset }}"
      sizes="96px"
      src="{{ $responsive.fallback.RelPermalink }}"
      width="96"
      height="96"
      alt="{{ $display }}"
      loading="lazy"
      />
  {{ end }}
  <div class="place-self-center">
    <div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">
      {{ i18n "authors" }}
    </div>
    <div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">
      <span class="inline-block">
        {{if $author_url}}<a href="{{ $author_url }}" class="no-underline" {{ if $is_external }}target="_blank" rel="noopener"{{ end }}>{{end}}
        {{ $display }}
        {{if $author_url}}</a>{{end}}
      </span>
      {{- with $profile.pronouns -}}
        <span class="text-sm font-normal text-gray-600 dark:text-gray-400 ml-1 inline-block">({{ . }})</span>
      {{- end -}}
    </div>

    {{ with $profile.role }}
    <div class="text-sm font-bold text-neutral-700 dark:text-neutral-300">
    {{. | markdownify | emojify}}
    </div>
    {{end}}


    {{ with $profile.bio }}
    <div class="text-sm text-neutral-700 dark:text-neutral-300">{{ . | markdownify | emojify }}</div>
    {{ end }}

    <div class="text-2xl sm:text-lg pt-1">
      {{ partial "social_links" (dict "Params" (dict "profiles" $profile.links)) }}
    </div>
  </div>
</div>

{{end}}{{/* End Check for Author Profile */}}
